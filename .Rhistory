length(data[,contrast[1]])==1
length(data[,contrast[1]]==1)
sum(data[,contrast[1]]==1)
for (i in contrast) {
print(i)
print(sum(data[,data$i]==1))
tableau[tableau$contrast==i,2]<-sum(data$i==1)
}
for (i in contrast) {
print(data$i)
print(i)
print(sum(data[,data$i]==1))
tableau[tableau$contrast==i,2]<-sum(data$i==1)
}
data$AC1vsAC2
ncol(data)
for (i in 1:ncol(data)) {
print(data$i)
print(i)
print(sum(data[,data$i]==1))
tableau[tableau$contrast==i,2]<-sum(data$i==1)
}
for (i in 1:ncol(data)) {
print(data$i)
print(i)
print(sum(data[,data$i]==1))
tableau[tableau$contrast==i,2]<-sum(data[,contrast[i]]==1)
}
tableau
for (i in 1:ncol(data)) {
print(i)
print(sum(data[,data$i]==1))
tableau[tableau$contrast==i,2]<-sum(data[,contrast[i]]==1)
}
for (i in 1:ncol(data)) {
print(i)
print(sum(data[,contrast[1]]==1))
tableau[tableau$contrast==i,2]<-sum(data[,contrast[i]]==1)
}
for (i in 1:ncol(data)) {
print(i)
print(sum(data[,contrast[i]]==1))
tableau[tableau$contrast==i,2]<-sum(data[,contrast[i]]==1)
}
for (i in 1:ncol(data)) {
print(i)
print(sum(data[,contrast[i]]==1))
tableau[i,2]<-sum(data[,contrast[i]]==1)
}
tableau
for (i in 1:ncol(data)) {
tableau[i,2]<-sum(data[,contrast[i]]==1)
tableau[i,3]<-sum(data[,contrast[i]]==-1)
}
tableau
data$AC2vsAC3
barplot(tableau)
tableau
barplot(cbind(tableau$`UP`, tableau$`DOWN`) ~ IB$contrast,
beside = TRUE,
xlab = "contrast")
barplot(cbind(tableau$`UP`, tableau$`DOWN`) ~ tableau$contrast,
beside = TRUE,
xlab = "contrast")
tableau$`UP`
mode(tableau)
tableau=as.matrix(tableau)
mode(tableau)
barplot(cbind(tableau$`UP`, tableau$`DOWN`) ~ tableau$contrast,
beside = TRUE,
xlab = "contrast")
for (i in 1:ncol(data)) {
tableau[i,2]<-sum(data[,contrast[i]]==1)
tableau[i,3]<-sum(data[,contrast[i]]==-1)
}
tableau
tableau=as.data.frame(tableau)
mode(tableau)
barplot(cbind(tableau$`UP`, tableau$`DOWN`) ~ tableau$contrast,
beside = TRUE,
xlab = "contrast")
tableau$`DOWN`
for (i in 1:ncol(data)) {
tableau[i,2]<-sum(data[,contrast[i]]==1)
tableau[i,3]<-sum(data[,contrast[i]]==-1)
}
tableau
tableau=data.frame(tableau)
mode(tableau)
barplot(cbind(tableau$`UP`, tableau$`DOWN`) ~ tableau$contrast,
beside = TRUE,
xlab = "contrast")
for (i in 1:ncol(data)) {
tableau[i,2]<-as.numeric(sum(data[,contrast[i]]==1))
tableau[i,3]<-as.numeric(sum(data[,contrast[i]]==-1))
}
tableau
barplot(cbind(tableau$`UP`, tableau$`DOWN`) ~ tableau$contrast,
beside = TRUE,
xlab = "contrast")
mode(tableau)
tableau=data.frame(tableau)
mode(tableau)
barplot(tableau)
barplot(cbind(tableau$`UP`, tableau$`DOWN`) ~ tableau$contrast,
beside = TRUE,
xlab = "contrast")
class(tableau$UP)
tableau$UP=as.numeric(tableau$UP)
class(tableau$UP)
tableau$DOWN=as.numeric(tableau$DOWN)
for (i in 1:ncol(data)) {
tableau[i,2]<-sum(data[,contrast[i]]==1)
tableau[i,3]<-sum(data[,contrast[i]]==-1)
}
tableau
tableau$UP=as.numeric(tableau$UP)
tableau$DOWN=as.numeric(tableau$DOWN)
class(tableau$UP)
barplot(cbind(tableau$`UP`, tableau$`DOWN`) ~ tableau$contrast,
beside = TRUE,
xlab = "contrast")
barplot(cbind(tableau$`UP`, tableau$`DOWN`) ~ tableau$contrast,
#beside = TRUE,
xlab = "contrast")
barplot(cbind(tableau$`UP`, tableau$`DOWN`) ~ tableau$contrast,
#beside = TRUE,
xlab = "contrast",
col = c("green", "purple"),
legend.text = c("UP", "DOWN")))
barplot(cbind(tableau$`UP`, tableau$`DOWN`) ~ tableau$contrast,
#beside = TRUE,
#xlab = "contrast",
col = c("green", "purple"),
legend.text = c("UP", "DOWN"))
specie <- c(rep("sorgho" , 3) , rep("poacee" , 3) , rep("banana" , 3) , rep("triticum" , 3) )
condition <- rep(c("normal" , "stress" , "Nitrogen") , 4)
value <- abs(rnorm(12 , 0 , 15))
test <- data.frame(specie,condition,value)
test
tableau2 = pivot_longer(tableau)
head(data)
tableau
tableau2 = pivot_longer(tableau, cols = colnames(tableau))
tableau2
pivot_longer(tableau, cols = colnames(tableau))
tableau
tableau2
tableau3 = pivot_longer(tableau, cols = colnames(tableau))
head(data)
tableau3 = pivot_longer(data, cols = colnames(data))
tableau3
head(tableau3)
tableau4 = tableau3[value!=0,]
tableau3[value!=0,]
tableau4 = tableau3[tableau3$value!=0,]
tableau4
specie <- c(rep("sorgho" , 3) , rep("poacee" , 3) , rep("banana" , 3) , rep("triticum" , 3) )
condition <- rep(c("normal" , "stress" , "Nitrogen") , 4)
value <- abs(rnorm(12 , 0 , 15))
test <- data.frame(specie,condition,value)
test
ggplot(tableau4, aes(fill=value, y=value, x=name)) +
geom_bar(position="dodge", stat="identity")
tableau5 =
tableau4$value==1 <- "UP"
tableau5 =
tableau4[tableau4$value==1] <- "UP"
tableau5 =
tableau4[tableau4$value=1] <- "UP"
tableau5 =
tableau4[tableau4$value=1,] <- "UP"
tableau5 =
tableau4[,tableau4$value=1] <- "UP"
tableau5 =
tableau4[]==1 <- "UP"
tableau4$value[data$value==1]<-"UP"
tableau4
tableau4$value[data$value=1]<-"UP"
tableau4$value[tableau4$value==1]<-"UP"
tableau4
tableau4$value[tableau4$value==-1]<-"DOWN"
tableau4
ggplot(tableau4, aes(fill=value, y=value, x=name)) +
geom_bar(position="dodge", stat="identity")
data
tableau
tableau6 = pivot_longer(tableau, cols = c("UP","DOWN"))
tableau6
ggplot(tableau6, aes(fill=value, y=value, x=name)) +
geom_bar(position="dodge", stat="identity")
ggplot(tableau6, aes(fill=name, y=value, x=contrast)) +
geom_bar(position="dodge", stat="identity")
ggplot(tableau6, aes(fill=name, y=value, x=contrast)) +
geom_bar(position="dodge", stat="identity")
ggplot(data=tableau6, aes(x=contrast, y=value, fill=name)) +
geom_bar(stat="identity")+
geom_text(aes(y=label_ypos, label=len), vjust=1.6,
color="white", size=3.5)+
scale_fill_brewer(palette="Paired")+
theme_minimal()
ggplot(data=tableau6, aes(x=contrast, y=value, fill=name)) +
geom_bar(stat="identity")+
#geom_text(aes(y=label_ypos, label=len), vjust=1.6,
#   color="white", size=3.5)+
scale_fill_brewer(palette="Paired")+
theme_minimal()
df_cumsum <- ddply(tableau6, "name",
transform, label_ypos=cumsum(len))
library(dplyr)
df_cumsum <- ddply(tableau6, "name",
transform, label_ypos=cumsum(len))
library(plyr)
df_cumsum <- ddply(tableau6, "name",
transform, label_ypos=cumsum(len))
df_cumsum <- ddply(tableau6, "name",
df_cumsum <- ddply(tableau6, "name",
transform, label_ypos=cumsum(name))
head(df_cumsum)
df_cumsum <- ddply(tableau6, "name",
transform, label_ypos=cumsum(name))
df_cumsum
df_cumsum <- ddply(tableau6, "value",
transform, label_ypos=cumsum(value))
df_cumsum
ggplot(data=tableau6, aes(x=contrast, y=value, fill=name)) +
geom_bar(stat="identity")+
geom_text(aes( label=value), vjust=1.6,
color="white", size=3.5)+
scale_fill_brewer(palette="Paired")+
theme_minimal()
ggplot(data=tableau6, aes(x=contrast, y=value, fill=name)) +
geom_bar(stat="identity")+
geom_text(aes( label=value), vjust=1.6,
color="white", size=3.5)+
scale_fill_brewer(palette="Paired")+
theme_minimal()+
facet_wrap(~name)
ggplot(data=tableau6, aes(x=contrast, y=value, fill=name)) +
geom_bar(stat="identity")+
geom_text(aes( label=value), vjust=1.6,
color="white", size=3.5)+
scale_fill_brewer(palette="Paired")+
theme_minimal()+
facet_wrap(~name, ncol=1)
ggplot(data=tableau6, aes(x=contrast, y=value, fill=-name)) +
geom_bar(stat="identity")+
geom_text(aes( label=value), vjust=1.6,
color="white", size=3.5)+
scale_fill_brewer(palette="Paired")+
theme_minimal()+
facet_wrap(~name, ncol=1)
ggplot(data=tableau6, aes(x=contrast, y=value, fill=name)) +
geom_bar(stat="identity")+
geom_text(aes( label=value), vjust=1.6,
color="white", size=3.5)+
scale_fill_brewer(palette="Paired")+
theme_minimal()+
facet_wrap(~name, ncol=1)
ggplot(data=tableau6, aes(x=contrast, y=value, fill=name)) +
geom_bar(stat="identity")+
geom_text(aes( label=value), vjust=1.6,
color="white", size=3.5)+
scale_fill_brewer(palette="Paired")+
#theme_minimal()+
facet_wrap(~name, ncol=1)
ggplot(data=tableau6, aes(x=contrast, y=value, fill=name)) +
geom_bar(stat="identity")+
geom_text(aes( label=value), vjust=1.6,
color="black", size=3.5)+
scale_fill_brewer(palette="Paired")+
#theme_minimal()+
facet_wrap(~name, ncol=1)
ggplot(data=tableau6, aes(x=contrast, y=value, fill=fct_rev(name)) +
geom_bar(stat="identity")+
geom_text(aes( label=value), vjust=1.6,
color="black", size=3.5)+
scale_fill_brewer(palette="Paired")+
#theme_minimal()+
facet_wrap(~name, ncol=1))
ggplot(data=tableau6, aes(x=contrast, y=value, fill=fct_rev(name) +
ggplot(data=tableau6, aes(x=contrast, y=value, fill=fct_rev(name))) +
geom_bar(stat="identity")+
geom_text(aes( label=value), vjust=1.6,
color="black", size=3.5)+
scale_fill_brewer(palette="Paired")+
#theme_minimal()+
facet_wrap(~name, ncol=1)
ggplot(data=tableau6, aes(x=contrast, y=value, fill=name)) +
ggplot(data=tableau6, aes(x=contrast, y=value, fill=name)) +
geom_bar(stat="identity")+
geom_text(aes( label=value), vjust=1.6,
color="white", size=3.5)+
scale_fill_brewer(palette="Paired")+
#theme_minimal()+
facet_wrap(~name, ncol=1)
ggplot(data=tableau6, aes(x=contrast, y=value, fill=name)) +
geom_bar(stat="identity")+
geom_text(aes( label=value), vjust=1.6,
color="white", size=3.5)+
scale_fill_brewer(palette="Paired")+
#theme_minimal()+
facet_wrap(~fct_rev(name), ncol=1)
ggplot(data=tableau6, aes(x=contrast, y=value, fill=name)) +
geom_bar(stat="identity")+
geom_text(aes( label=value), vjust=1.6,
color="black", size=3.5)+
scale_fill_brewer(palette="Paired")+
#theme_minimal()+
facet_wrap(~fct_rev(name), ncol=1)
ggplot(data=tableau6, aes(x=contrast, y=value, fill=name)) +
geom_bar(stat="identity")+
geom_text(aes( label=value), vjust=0,
color="black", size=3.5)+
scale_fill_brewer(palette="Paired")+
#theme_minimal()+
facet_wrap(~fct_rev(name), ncol=1)
ggplot(data=tableau6, aes(x=contrast, y=value, fill=name)) +
geom_bar(stat="identity")+
geom_text(aes( label=value), vjust=-0.5,
color="black", size=3.5)+
scale_fill_brewer(palette="Paired")+
#theme_minimal()+
facet_wrap(~fct_rev(name), ncol=1)
ggplot(data=tableau6, aes(x=contrast, y=value, fill=name)) +
geom_bar(stat="identity")+
geom_text(aes( label=value), vjust=-0.5,
color="black", size=3.5)+
scale_fill_brewer(palette="Paired")+
xlim(15, 20)+
#theme_minimal()+
facet_wrap(~fct_rev(name), ncol=1)
ggplot(data=tableau6, aes(x=contrast, y=value, fill=name)) +
geom_bar(stat="identity")+
geom_text(aes( label=value), vjust=-0.5,
color="black", size=3.5)+
scale_fill_brewer(palette="Paired")+
xlim(15, 1500)+
#theme_minimal()+
facet_wrap(~fct_rev(name), ncol=1)
ggplot(data=tableau6, aes(x=contrast, y=value, fill=name)) +
geom_bar(stat="identity")+
geom_text(aes( label=value), vjust=-0.5,
color="black", size=3.5)+
scale_fill_brewer(palette="Paired")+
ylim(15, 1500)+
#theme_minimal()+
facet_wrap(~fct_rev(name), ncol=1)
ggplot(data=tableau6, aes(x=contrast, y=value, fill=name)) +
geom_bar(stat="identity")+
geom_text(aes( label=value), vjust=-0.5,
color="black", size=3.5)+
scale_fill_brewer(palette="Paired")+
#ylim(15, 1500)+
#theme_minimal()+
facet_wrap(~fct_rev(name), ncol=1)
ggplot(data=tableau6, aes(x=contrast, y=value, fill=name)) +
geom_bar(stat="identity")+
geom_text(aes( label=value), vjust=-0.5,
color="black", size=3.5)+
scale_fill_brewer(palette="Paired")+
ylim(0, 2500)+
#theme_minimal()+
facet_wrap(~fct_rev(name), ncol=1)
tableau6
max(tableau6$value)
tableau6$value+10%
tableau6$value+(0.1*tableau6$value)
max(tableau6$value)+(0.1*max(tableau6$value))
ggplot(data=tableau6, aes(x=contrast, y=value, fill=name)) +
geom_bar(stat="identity")+
geom_text(aes( label=value), vjust=-0.5,
color="black", size=3.5)+
scale_fill_brewer(palette="Paired")+
ylim(0, max(tableau6$value)+(0.1*max(tableau6$value)))+
#theme_minimal()+
facet_wrap(~fct_rev(name), ncol=1)
head(tableau6)
names(tableau6)
head(tableau6)
ggplot(data=tableau6, aes(x=contrast, y=value, fill=name)) +
geom_bar(stat="identity")+
geom_text(aes( label=value), vjust=-0.5,
color="black", size=3.5)+
scale_fill_brewer(palette="Paired")+
ylim(0, max(tableau6$value)+(0.1*max(tableau6$value)))+
#theme_minimal()+
facet_wrap(~fct_rev(name), ncol=1)+
labs(fill = "Expression")
ggplot(data=tableau6, aes(x=contrast, y=value, fill=name)) +
geom_bar(stat="identity")+
geom_text(aes( label=value), vjust=-0.5,
color="black", size=3.5)+
scale_fill_brewer(palette="Paired")+
ylim(0, max(tableau6$value)+(0.1*max(tableau6$value)))+
#theme_minimal()+
facet_wrap(~fct_rev(name), ncol=1)+
labs(fill = "Expression",title = "Number of DEGs in each contrast",ylab"COUCOU")
ggplot(data=tableau6, aes(x=contrast, y=value, fill=name)) +
geom_bar(stat="identity")+
geom_text(aes( label=value), vjust=-0.5,
color="black", size=3.5)+
scale_fill_brewer(palette="Paired")+
ylim(0, max(tableau6$value)+(0.1*max(tableau6$value)))+
#theme_minimal()+
facet_wrap(~fct_rev(name), ncol=1)+
labs(fill = "Expression",title = "Number of DEGs in each contrast",ylab="COUCOU")
ggplot(data=tableau6, aes(x=contrast, y=value, fill=name)) +
geom_bar(stat="identity")+
geom_text(aes( label=value), vjust=-0.5,
color="black", size=3.5)+
scale_fill_brewer(palette="Paired")+
ylim(0, max(tableau6$value)+(0.1*max(tableau6$value)))+
#theme_minimal()+
facet_wrap(~fct_rev(name), ncol=1)+
labs(fill = "Expression",title = "Number of DEGs in each contrast")+
ylab("COUCOU")
ggplot(data=tableau6, aes(x=contrast, y=value, fill=name)) +
geom_bar(stat="identity")+
geom_text(aes( label=value), vjust=-0.5,
color="black", size=3.5)+
scale_fill_brewer(palette="Paired")+
ylim(0, max(tableau6$value)+(0.1*max(tableau6$value)))+
#theme_minimal()+
facet_wrap(~fct_rev(name), ncol=1)+
labs(fill = "Expression",title = "Number of DEGs in each contrast")+
ylab("Nulber of DEGs")+
xlab("Contrast")
ggplot(data=tableau6, aes(x=contrast, y=value, fill=name)) +
geom_bar(stat="identity")+
geom_text(aes( label=value), vjust=-0.5,
color="black", size=3.5)+
scale_fill_brewer(palette="Paired")+
ylim(0, max(tableau6$value)+(0.1*max(tableau6$value)))+
#theme_minimal()+
facet_wrap(~fct_rev(name), ncol=1)+
labs(fill = "Differential\nExpression",title = "Number of DEGs in each contrast")+
ylab("Nulber of DEGs")+
xlab("Contrast")
ggplot(data=tableau6, aes(x=contrast, y=value, fill=fct_rev(name))) +
geom_bar(stat="identity")+
geom_text(aes( label=value), vjust=-0.5,
color="black", size=3.5)+
scale_fill_brewer(palette="Paired")+
ylim(0, max(tableau6$value)+(0.1*max(tableau6$value)))+
#theme_minimal()+
facet_wrap(~fct_rev(name), ncol=1)+
labs(fill = "Differential\nExpression",title = "Number of DEGs in each contrast")+
ylab("Nulber of DEGs")+
xlab("Contrast")
ggplot(data=tableau6, aes(x=contrast, y=value, fill=name)) +
geom_bar(stat="identity")+
geom_text(aes( label=value), vjust=-0.5,
color="black", size=3.5)+
scale_fill_brewer(palette="Paired")+
ylim(0, max(tableau6$value)+(0.1*max(tableau6$value)))+
#theme_minimal()+
facet_wrap(~fct_rev(name), ncol=1)+
labs(fill = "Differential\nExpression",title = "Number of DEGs in each contrast")+
ylab("Nulber of DEGs")+
xlab("Contrast")
comp_names <- c( `UP` = "UP in first condition", `DOWN` = "DOWN in first condition")
ggplot(data=tableau6, aes(x=contrast, y=value, fill=name)) +
geom_bar(stat="identity")+
geom_text(aes( label=value), vjust=-0.5,
color="black", size=3.5)+
scale_fill_brewer(palette="Paired", labels=comp_names)+
ylim(0, max(tableau6$value)+(0.1*max(tableau6$value)))+
#theme_minimal()+
facet_wrap(~fct_rev(name), ncol=1)+
labs(fill = "Differential\nExpression",title = "Number of DEGs in each contrast")+
ylab("Number of DEGs")+
xlab("Contrast")
ggplot(data=tableau6, aes(x=contrast, y=value, fill=name)) +
geom_bar(stat="identity")+
geom_text(aes( label=value), vjust=-0.5,
color="black", size=3.5)+
scale_fill_brewer(palette="Paired", labels=comp_names)+
ylim(0, max(tableau6$value)+(0.1*max(tableau6$value)))+
#theme_minimal()+
facet_wrap(~fct_rev(name), ncol=1)+
labs(fill = "Differential\nExpression",title = "Number of DEGs in each contrast", subtitle="(DEGs = Diffentially Expressed Genes)")+
ylab("Number of DEGs")+
xlab("Contrast")
data = read.delim("C:/DATA_KEVIN/INRA/AskoR/inst/extdata/DEG_test/DEanalysis/DEtables/Summary_DEresults.txt")
head(data)
barplot(data[,2:10])
data = data[,2:10]
contrast = colnames(data)
contrast
for (i in contrast) {print(i)}
tableau = data.frame(contrast=colnames(data), UP=0, DOWN=0)
tableau
for (i in 1:ncol(data)) {
tableau[i,2]<-sum(data[,contrast[i]]==1)
tableau[i,3]<-sum(data[,contrast[i]]==-1)
}
head(tableau)
tableau6 = pivot_longer(tableau, cols = c("UP","DOWN"))
head(tableau6)
comp_names <- c( `UP` = "UP in first condition", `DOWN` = "DOWN in first condition")
ggplot(data=tableau6, aes(x=contrast, y=value, fill=name)) +
geom_bar(stat="identity")+
geom_text(aes( label=value), vjust=-0.5,
color="black", size=3.5)+
scale_fill_brewer(palette="Paired", labels=comp_names)+
ylim(0, max(tableau6$value)+(0.1*max(tableau6$value)))+
#theme_minimal()+
facet_wrap(~fct_rev(name), ncol=1)+
labs(fill = "Differential\nExpression",title = "Number of DEGs in each contrast", subtitle="(DEGs = Diffentially Expressed Genes)")+
ylab("Number of DEGs")+
xlab("Contrast")
